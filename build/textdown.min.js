/*! textdown 2013-10-26 */
!function(a){var b=function(a){this.textile=a,this.text=this.textile,this.preBlocks=[]},c=b.prototype;c.convertHeaders=function(){var a=/^(h[1-6])\.\s?(.*)$/gm;this.text=this.text.replace(a,"<$1>$2</$1>")},c.convertBlockQuotes=function(){var a=/^bq\.\s?(.*)$/gm;this.text=this.text.replace(a,"<blockquote><p>$1</p></blockquote>")},c.convertLists=function(){for(var a="",b=this.text.split(/\n/gm),c=!1,d="ul",e=0;e<b.length;e++){var f=b[e],g="#"===f.charAt(0),h="*"===f.charAt(0),i=f.match(/\*/g),j=i&&i.length>1;g||h&&!j?(g&&(d="ol"),c||(c=!0,a+="<"+d+">"),a+="<li>"+f.substr(2)+"</li>",e===b.length-1&&(c=!1,a+="</"+d+">")):(0===f.length&&c&&(c=!1,a+="</"+d+">"),a+="\n"+f+"\n")}this.text=a},c.parsePreBlocks=function(){var a=/(<pre[^>]*>[\s\S]+?<\/pre>)/gm,b=this.text.match(a)||[];b.length&&(this.preBlocks=b,this.text=this.text.replace(a,"^^^^^^"))},c.revertPreBlocks=function(){if(this.preBlocks.length)for(var a=0;a<this.preBlocks.length;a++){var b=this.preBlocks[a];this.text=this.text.replace("^^^^^^",b)}},c.convertParagraphs=function(){for(var a=this.text.trim().split(/\n{2,}/gm),b=0;b<a.length;b++){var c=a[b];"<"!==c.charAt(0)&&"^^^^^^"!==c&&(a[b]="<p>"+a[b]+"</p>")}this.text=a.join("")},c.convertQuotes=function(){var a="&#8220;",b="&#8221;",c=/\s\"([^\"]+)\"/gm;this.text=this.text.replace(c,function(c){var d=c;return d=d.replace(/\"/,a),d=d.replace(/\"/,b)})},c.convertDoubleHyphens=function(){this.text=this.text.replace(/\s*--\s*/gm,"&#8212;")},c.convertSingleHyphens=function(){this.text=this.text.replace(/\s(-)\s/gm,function(a){return a.replace("-","&#8211;")})},c.convertTripleDots=function(){this.text=this.text.replace(/\.{3}/gm,"&#8230;")},c.convertDimensions=function(){this.text=this.text.replace(/\sx\s/gm,"&#215;")},c.convertSymbols=function(){function a(a){var b={"(TM)":"&#8482;","(R)":"&#174;","(C)":"&#169;"};return b[a]}var b=/\((TM|R|C)\)/gm;this.text=this.text.replace(b,a)},c.convertLinks=function(){var a=/\"([^\"]+)\"\:((http|ftp|https):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-\_]*[\w@?^=%&amp;\/~+#-\)]))?/gm;this.text=this.text.replace(a,'<a href="$2">$1</a>')},c.convertImages=function(){var a=/!(([^!\s\(]+)(\((\w+)\))?)!/gm;this.text=this.text.replace(a,function(a,b,c,d,e){return e=e||"",'<img src="'+c+'" alt="'+e+'" />'})},c.convertEmphasis=function(){var a=/_([^_]+)_/gm;this.text=this.text.replace(a,"<em>$1</em>")},c.convertBold=function(){var a=/\*([^\*]+)\*/gm;this.text=this.text.replace(a,"<strong>$1</strong>")},c.convertCitations=function(){var a=/\?{2}([^\?]+)\?{2}/gm;this.text=this.text.replace(a,"<cite>$1</cite>")},c.convertInlineCode=function(){var a=/\@([^\@]+)\@/gm;this.text=this.text.replace(a,"<code>$1</code>")},c.convertStrikethroughs=function(){var a=/-([^-]+)-/gm;this.text=this.text.replace(a,"<del>$1</del>")},c.convertInserts=function(){var a=/\+([^\+]+)\+/gm;this.text=this.text.replace(a,"<ins>$1</ins>")},c.convertSuperscripts=function(){var a=/\^([^\^]+)\^/gm;this.text=this.text.replace(a,"<sup>$1</sup>")},c.convertSubscripts=function(){var a=/\~([^\~]+)\~/gm;this.text=this.text.replace(a,"<sub>$1</sub>")},c.toHtml=function(){return this.parsePreBlocks(),this.convertStrikethroughs(),this.convertHeaders(),this.convertLinks(),this.convertImages(),this.convertQuotes(),this.convertDoubleHyphens(),this.convertSingleHyphens(),this.convertTripleDots(),this.convertDimensions(),this.convertSymbols(),this.convertLists(),this.convertEmphasis(),this.convertCitations(),this.convertInlineCode(),this.convertBlockQuotes(),this.convertParagraphs(),this.convertInserts(),this.convertSuperscripts(),this.convertSubscripts(),this.convertBold(),this.revertPreBlocks(),this.text},a.Textdown=b}(window);